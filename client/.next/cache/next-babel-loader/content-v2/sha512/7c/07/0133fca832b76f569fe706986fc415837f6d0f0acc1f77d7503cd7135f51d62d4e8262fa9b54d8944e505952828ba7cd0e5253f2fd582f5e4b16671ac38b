{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/wen_wong/voting-at-mcgill/client/src/pages/newGroup.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport { Header } from '../components/header';\nimport VoteFactoryContract from \"../contracts/VoteFactory.json\";\nimport VoteContract from \"../contracts/Vote.json\";\nimport { Form } from \"semantic-ui-react\";\nimport getWeb3 from \"../getWeb3\";\nimport 'semantic-ui-css/semantic.min.css';\nvar adminTitle = {\n  color: \"red\",\n  marginBottom: \"5%\",\n  fontSize: \"3em\",\n  textAlign: \"center\"\n};\nvar adminFields = {\n  margin: \"auto 5% auto 5%\"\n};\n\nvar NewGroup = function NewGroup() {\n  _s();\n\n  var _useState = useState(''),\n      web3 = _useState[0],\n      setWeb3 = _useState[1];\n\n  var web3Instance;\n  useEffect(function () {\n    function initWeb3() {\n      return _initWeb.apply(this, arguments);\n    }\n\n    function _initWeb() {\n      _initWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return getWeb3();\n\n              case 2:\n                web3Instance = _context.sent;\n                setWeb3(web3Instance);\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _initWeb.apply(this, arguments);\n    }\n\n    initWeb3();\n  }, []);\n\n  var _useState2 = useState(''),\n      groupName = _useState2[0],\n      setGroupName = _useState2[1];\n\n  var _useState3 = useState(''),\n      description = _useState3[0],\n      setDescription = _useState3[1];\n\n  var _useState4 = useState(''),\n      groupID = _useState4[0],\n      setGroupID = _useState4[1];\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(event) {\n      var manager, factoryContract, voteContract, addressOfVote, setupVoteFactory, setupVote, createGroup, displayGroup;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              event.preventDefault();\n\n              setupVoteFactory = /*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                  var _yield$web3$eth$getAc, _yield$web3$eth$getAc2, networkId, deployedNetwork, instance;\n\n                  return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                      switch (_context2.prev = _context2.next) {\n                        case 0:\n                          if (!(web3 == '')) {\n                            _context2.next = 2;\n                            break;\n                          }\n\n                          return _context2.abrupt(\"return\");\n\n                        case 2:\n                          _context2.prev = 2;\n                          _context2.next = 5;\n                          return web3.eth.getAccounts();\n\n                        case 5:\n                          _yield$web3$eth$getAc = _context2.sent;\n                          _yield$web3$eth$getAc2 = _slicedToArray(_yield$web3$eth$getAc, 1);\n                          manager = _yield$web3$eth$getAc2[0];\n                          _context2.next = 10;\n                          return web3.eth.net.getId();\n\n                        case 10:\n                          networkId = _context2.sent;\n                          deployedNetwork = VoteFactoryContract.networks[networkId];\n                          instance = new web3.eth.Contract(VoteFactoryContract.abi, deployedNetwork && deployedNetwork.address);\n                          factoryContract = instance; // Set web3, accounts, and contract to the state, and then proceed with an\n\n                          _context2.next = 20;\n                          break;\n\n                        case 16:\n                          _context2.prev = 16;\n                          _context2.t0 = _context2[\"catch\"](2);\n                          // Catch any errors for any of the above operations.\n                          alert(\"Failed to load web3, accounts, or contract. Check console for details.\");\n                          console.error(_context2.t0);\n\n                        case 20:\n                        case \"end\":\n                          return _context2.stop();\n                      }\n                    }\n                  }, _callee2, null, [[2, 16]]);\n                }));\n\n                return function setupVoteFactory() {\n                  return _ref2.apply(this, arguments);\n                };\n              }();\n\n              setupVote = /*#__PURE__*/function () {\n                var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                  var instance;\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          _context3.prev = 0;\n                          _context3.next = 3;\n                          return new web3.eth.Contract(VoteContract.abi, addressOfVote);\n\n                        case 3:\n                          instance = _context3.sent;\n                          voteContract = instance;\n                          _context3.next = 11;\n                          break;\n\n                        case 7:\n                          _context3.prev = 7;\n                          _context3.t0 = _context3[\"catch\"](0);\n                          // Catch any errors for any of the above operations.\n                          alert(\"Failed to load web3, accounts, or contract. Check console for details.\");\n                          console.error(_context3.t0);\n\n                        case 11:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3, null, [[0, 7]]);\n                }));\n\n                return function setupVote() {\n                  return _ref3.apply(this, arguments);\n                };\n              }();\n\n              createGroup = /*#__PURE__*/function () {\n                var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n                  return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                    while (1) {\n                      switch (_context4.prev = _context4.next) {\n                        case 0:\n                          if (!(factoryContract == '')) {\n                            _context4.next = 2;\n                            break;\n                          }\n\n                          return _context4.abrupt(\"return\");\n\n                        case 2:\n                          _context4.next = 4;\n                          return factoryContract.methods.createGroup(groupName, description, groupID).send({\n                            from: manager\n                          });\n\n                        case 4:\n                        case \"end\":\n                          return _context4.stop();\n                      }\n                    }\n                  }, _callee4);\n                }));\n\n                return function createGroup() {\n                  return _ref4.apply(this, arguments);\n                };\n              }();\n\n              displayGroup = /*#__PURE__*/function () {\n                var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n                  var numOfGroups, summary, i;\n                  return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                    while (1) {\n                      switch (_context5.prev = _context5.next) {\n                        case 0:\n                          _context5.next = 2;\n                          return voteFactoryContract.methods.getNumOfGroups().call();\n\n                        case 2:\n                          numOfGroups = _context5.sent;\n                          summary = [numOfGroups];\n                          i = 0;\n\n                        case 5:\n                          if (!(i < numOfGroups)) {\n                            _context5.next = 12;\n                            break;\n                          }\n\n                          _context5.next = 8;\n                          return voteContract.methods.call();\n\n                        case 8:\n                          summary[i] = _context5.sent;\n\n                        case 9:\n                          i++;\n                          _context5.next = 5;\n                          break;\n\n                        case 12:\n                          console.log(summary);\n\n                        case 13:\n                        case \"end\":\n                          return _context5.stop();\n                      }\n                    }\n                  }, _callee5);\n                }));\n\n                return function displayGroup() {\n                  return _ref5.apply(this, arguments);\n                };\n              }();\n\n              _context6.next = 7;\n              return setupVoteFactory();\n\n            case 7:\n              _context6.next = 9;\n              return setupVote();\n\n            case 9:\n              _context6.next = 11;\n              return createGroup();\n\n            case 11:\n              _context6.next = 13;\n              return displayGroup();\n\n            case 13:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function onSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }\n  }), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }\n  }), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  }), __jsx(\"h1\", {\n    style: adminTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }\n  }, \"New Group\"), __jsx(Form, {\n    onSubmit: onSubmit,\n    style: adminFields,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 17\n    }\n  }, __jsx(Form.Input, {\n    required: true,\n    label: \"Group name\",\n    value: groupName,\n    onChange: function onChange(event) {\n      return setGroupName(event.target.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }\n  })), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }\n  }), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }\n  }, __jsx(Form.TextArea, {\n    required: true,\n    label: \"Description\",\n    value: description,\n    onChange: function onChange(event) {\n      return setDescription(event.target.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 21\n    }\n  })), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 17\n    }\n  }), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 17\n    }\n  }, __jsx(Form.Input, {\n    required: true,\n    label: \"Group ID\",\n    value: groupID,\n    onChange: function onChange(event) {\n      return setGroupID(event.target.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 21\n    }\n  })), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 17\n    }\n  }), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  }, __jsx(Form.Button, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 21\n    }\n  }, \"Cancel\"), __jsx(Form.Button, {\n    type: \"submit\",\n    onSubmit: onSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 21\n    }\n  }, \"Create Group\"))));\n};\n\n_s(NewGroup, \"noBHOoKIgPD6p45SlH4epsn+P1w=\");\n\n_c = NewGroup;\nexport default NewGroup;\n\nvar _c;\n\n$RefreshReg$(_c, \"NewGroup\");","map":{"version":3,"sources":["/home/wen_wong/voting-at-mcgill/client/src/pages/newGroup.js"],"names":["React","useState","useEffect","Header","VoteFactoryContract","VoteContract","Form","getWeb3","adminTitle","color","marginBottom","fontSize","textAlign","adminFields","margin","NewGroup","web3","setWeb3","web3Instance","initWeb3","groupName","setGroupName","description","setDescription","groupID","setGroupID","onSubmit","event","preventDefault","setupVoteFactory","eth","getAccounts","manager","net","getId","networkId","deployedNetwork","networks","instance","Contract","abi","address","factoryContract","alert","console","error","setupVote","addressOfVote","voteContract","createGroup","methods","send","from","displayGroup","voteFactoryContract","getNumOfGroups","call","numOfGroups","summary","i","log","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Header } from '../components/header';\nimport VoteFactoryContract from \"../contracts/VoteFactory.json\";\nimport VoteContract from \"../contracts/Vote.json\";\nimport { Form } from \"semantic-ui-react\";\nimport getWeb3 from \"../getWeb3\";\nimport 'semantic-ui-css/semantic.min.css';\n\nconst adminTitle = {\n    color: \"red\",\n    marginBottom: \"5%\",\n    fontSize: \"3em\",\n    textAlign: \"center\"\n};\n\nconst adminFields = {\n    margin: \"auto 5% auto 5%\"\n};\n\nconst NewGroup = () => {\n\n    const [web3, setWeb3] = useState('');\n    var web3Instance;\n\n    useEffect(() => {\n        async function initWeb3() {\n            web3Instance = await getWeb3();\n            setWeb3(web3Instance);\n        }\n        initWeb3();\n    },[]);\n\n    const [groupName, setGroupName] = useState('');\n    const [description, setDescription] = useState('');\n    const [groupID, setGroupID] = useState('');\n\n    var onSubmit = async (event) => {\n        event.preventDefault();\n        var manager;\n        var factoryContract;\n        var voteContract;\n        var addressOfVote;\n        \n        var setupVoteFactory = async () => { //initializes voteFactory\n            if(web3 == '') {\n                return;\n            }\n            try {\n                [manager] = (await web3.eth.getAccounts());\n                // Get the contract instance.\n                const networkId = await web3.eth.net.getId();\n                const deployedNetwork = VoteFactoryContract.networks[networkId];\n                const instance = new web3.eth.Contract(\n                    VoteFactoryContract.abi,\n                    deployedNetwork && deployedNetwork.address,\n                );\n                factoryContract = instance;\n\n                // Set web3, accounts, and contract to the state, and then proceed with an\n            } catch (error) {\n                // Catch any errors for any of the above operations.\n                alert(\n                    `Failed to load web3, accounts, or contract. Check console for details.`,\n                );\n                console.error(error);\n            }\n        };\n\n        var setupVote = async () => {//initializes vote contract\n                    try {\n                        // Get the contract instance.\n                        const instance = await new web3.eth.Contract(\n                            VoteContract.abi,\n                            addressOfVote,\n                        );\n                        voteContract = instance;\n                    } catch (error) {\n                        // Catch any errors for any of the above operations.\n                        alert(\n                            `Failed to load web3, accounts, or contract. Check console for details.`,\n                        );\n                        console.error(error);\n                    }\n                };\n\n        var createGroup = async () => {//uses voteFactory to create Vote\n            if(factoryContract == ''){\n                return;\n            }\n            // Get the value from the contract to prove it worked.\n            await factoryContract.methods.createGroup(groupName, description, groupID).send({\n                from: manager\n            });\n        };\n\n        var displayGroup = async () => { // testing purposes\n            const numOfGroups = await voteFactoryContract.methods.getNumOfGroups().call();\n            const summary = [numOfGroups];\n            for (var i = 0; i <numOfGroups; i++) {\n                summary[i] = await voteContract.methods.call();\n            }\n            console.log(summary);\n        };\n        await setupVoteFactory();\n        await setupVote();\n        await createGroup();\n        await displayGroup();\n    };\n\n    return (\n        <>\n            <Header/>\n            <br></br>\n            <br></br>\n            <br></br>\n            <h1 style={adminTitle}>New Group</h1>\n            \n            <Form onSubmit={onSubmit} style={adminFields}>\n                <div>\n                    <Form.Input required label=\"Group name\"\n                                 value={groupName}\n                                 onChange={event => setGroupName(event.target.value)}\n                    >\n\n                    </Form.Input>\n                </div>\n\n                <br></br>\n                \n                <div>\n                    <Form.TextArea required\n                                 label=\"Description\"\n                                 value={description}\n                                 onChange={event => setDescription(event.target.value)}\n                    />\n                </div>\n\n                <br></br>\n\n                <div>\n                    <Form.Input required label=\"Group ID\"\n                                 value={groupID}\n                                 onChange={event => setGroupID(event.target.value)}\n                    >\n\n                    </Form.Input>\n                </div>\n\n                <br></br>\n                \n                <div>\n                    <Form.Button>Cancel</Form.Button>\n                    <Form.Button type=\"submit\" onSubmit={onSubmit}>Create Group</Form.Button>\n                </div>\n            </Form>\n        </>\n    )\n};\nexport default NewGroup;\n"]},"metadata":{},"sourceType":"module"}