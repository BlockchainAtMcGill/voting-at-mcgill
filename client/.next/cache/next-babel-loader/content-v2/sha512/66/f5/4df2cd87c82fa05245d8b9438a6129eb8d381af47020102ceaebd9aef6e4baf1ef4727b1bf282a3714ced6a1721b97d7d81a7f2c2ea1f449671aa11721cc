{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/wen_wong/voting-at-mcgill/client/src/pages/joinGroup.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from \"react\";\nimport VoteFactoryContract from \"../contracts/VoteFactory.json\";\nimport getWeb3 from \"../getWeb3\";\nimport { Form } from \"semantic-ui-react\";\nimport { Header } from '../components/header';\nimport 'semantic-ui-css/semantic.min.css';\n\nrequire(\"regenerator-runtime/runtime\"); // Card UI details\n\n\nvar styles = {\n  card: {\n    width: '90%',\n    margin: 'auto',\n    color: '#f00000',\n    maxHeight: 200,\n    minHeight: 200,\n    cursor: \"pointer\"\n  },\n  title: {\n    fontSize: 36,\n    color: '#ED1B2F',\n    marginLeft: 10,\n    marginTop: 15,\n    marginBottom: 15\n  },\n  access: {\n    position: \"relative\",\n    height: 36,\n    fontSize: 16\n  }\n}; // Initialize Join Group page\n\nvar JoinGroup = function JoinGroup() {\n  _s();\n\n  var _useState = useState(''),\n      web3 = _useState[0],\n      setWeb3 = _useState[1];\n\n  var _useState2 = useState(''),\n      groupsID = _useState2[0],\n      setGroupsID = _useState2[1];\n\n  var _useState3 = useState(''),\n      contract = _useState3[0],\n      setContract = _useState3[1];\n\n  var _useState4 = useState([]),\n      renderedGroups = _useState4[0],\n      renderGroups = _useState4[1];\n\n  var _useState5 = useState(false),\n      joiningGroup = _useState5[0],\n      setJoiningGroup = _useState5[1];\n\n  var user; // Setup Web3 on the current page\n\n  useEffect(function () {\n    function initWeb3() {\n      return _initWeb.apply(this, arguments);\n    }\n\n    function _initWeb() {\n      _initWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var web3Instance;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log('initializing web3');\n                _context.next = 3;\n                return getWeb3();\n\n              case 3:\n                web3Instance = _context.sent;\n                setWeb3(web3Instance);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _initWeb.apply(this, arguments);\n    }\n\n    initWeb3();\n  }, []); // Initializeing VoteFactory contract\n\n  useEffect(function () {\n    function setup() {\n      return _setup.apply(this, arguments);\n    }\n\n    function _setup() {\n      _setup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var _yield$web3$eth$getAc, _yield$web3$eth$getAc2, networkId, deployedNetwork, instance;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(web3 == \"\")) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                console.log('unable to get factory');\n                return _context2.abrupt(\"return\");\n\n              case 3:\n                _context2.prev = 3;\n                _context2.next = 6;\n                return web3.eth.getAccounts();\n\n              case 6:\n                _yield$web3$eth$getAc = _context2.sent;\n                _yield$web3$eth$getAc2 = _slicedToArray(_yield$web3$eth$getAc, 1);\n                user = _yield$web3$eth$getAc2[0];\n                _context2.next = 11;\n                return web3.eth.net.getId();\n\n              case 11:\n                networkId = _context2.sent;\n                deployedNetwork = VoteFactoryContract.networks[networkId];\n                instance = new web3.eth.Contract(VoteFactoryContract.abi, deployedNetwork && deployedNetwork.address);\n                setContract(instance);\n                _context2.next = 21;\n                break;\n\n              case 17:\n                _context2.prev = 17;\n                _context2.t0 = _context2[\"catch\"](3);\n                alert(\"Failed to load web3, accounts, or contract. Check console for details.\");\n                console.error(_context2.t0);\n\n              case 21:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[3, 17]]);\n      }));\n      return _setup.apply(this, arguments);\n    }\n\n    setup();\n  }, [web3]); // Return all group IDs as an array\n\n  useEffect(function () {\n    var displayVotes = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var response, temp, i;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(contract == '')) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\");\n\n              case 2:\n                _context3.next = 4;\n                return contract.methods.getExistingGroups().call();\n\n              case 4:\n                response = _context3.sent;\n                temp = [];\n\n                for (i = 0; i < response.length; i++) {\n                  temp[i] = parseInt(response[i]);\n                }\n\n                console.log(temp);\n                setGroupsID(temp);\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function displayVotes() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    displayVotes();\n  }, [contract]);\n\n  var displayInfo = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(identification) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!(groupsID == '')) {\n                _context4.next = 2;\n                break;\n              }\n\n              return _context4.abrupt(\"return\");\n\n            case 2:\n              _context4.prev = 2;\n              _context4.next = 5;\n              return contract.methods.getGroup(identification).call();\n\n            case 5:\n              return _context4.abrupt(\"return\", _context4.sent);\n\n            case 8:\n              _context4.prev = 8;\n              _context4.t0 = _context4[\"catch\"](2);\n              console.error(_context4.t0);\n\n            case 11:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[2, 8]]);\n    }));\n\n    return function displayInfo(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    //render votes\n    var renderVotes = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        var temp;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (groupsID) {\n                  _context5.next = 2;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\");\n\n              case 2:\n                temp = [];\n                _context5.next = 5;\n                return groupsID.forEach(function (identification) {\n                  displayInfo(identification).then(function (newGroup) {\n                    // Check if user has joined the group\n                    temp.push(newGroup);\n                  });\n                });\n\n              case 5:\n                setTimeout(function () {\n                  renderGroups(temp);\n                }, 1000);\n\n              case 6:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      return function renderVotes() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    renderVotes();\n  }, [groupsID]);\n  useEffect(function () {\n    if (renderedGroups) {\n      console.log(renderedGroups);\n    }\n  }, [renderedGroups]);\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(event) {\n      var joinGroup, displayJoin;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              event.preventDefault(); // Calls VoteFactory Contract to create a new instance of Group\n\n              joinGroup = /*#__PURE__*/function () {\n                var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n                  return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                    while (1) {\n                      switch (_context6.prev = _context6.next) {\n                        case 0:\n                          setJoiningGroup(true);\n\n                          if (!(contract == '')) {\n                            _context6.next = 3;\n                            break;\n                          }\n\n                          return _context6.abrupt(\"return\");\n\n                        case 3:\n                          _context6.next = 5;\n                          return contract.methods.joinGroup(groupID).send({\n                            from: user\n                          });\n\n                        case 5:\n                          setJoiningGroup(false);\n                          setLoad(!Load);\n\n                        case 7:\n                        case \"end\":\n                          return _context6.stop();\n                      }\n                    }\n                  }, _callee6);\n                }));\n\n                return function joinGroup() {\n                  return _ref5.apply(this, arguments);\n                };\n              }();\n\n              displayJoin = /*#__PURE__*/function () {\n                var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n                  var summary;\n                  return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                    while (1) {\n                      switch (_context7.prev = _context7.next) {\n                        case 0:\n                          _context7.next = 2;\n                          return contract.methods.getUserGroup(groupID).call();\n\n                        case 2:\n                          summary = _context7.sent;\n                          console.log(summary);\n\n                        case 4:\n                        case \"end\":\n                          return _context7.stop();\n                      }\n                    }\n                  }, _callee7);\n                }));\n\n                return function displayJoin() {\n                  return _ref6.apply(this, arguments);\n                };\n              }();\n\n              _context8.next = 5;\n              return setupVoteFactory();\n\n            case 5:\n              _context8.next = 7;\n              return joinGroup();\n\n            case 7:\n              _context8.next = 9;\n              return displayJoin();\n\n            case 9:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function onSubmit(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  function displayGroupList() {\n    var _this2 = this;\n\n    if (web3 == \"\") {\n      return \"waiting for votes to display...\";\n    } else if (groupsID == \"\") {\n      return \"no groups to display\";\n    }\n\n    return renderedGroups ? renderedGroups.map(function (group, index) {\n      return __jsx(\"div\", {\n        className: \"ui card\",\n        style: styles.card,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 5\n        }\n      }, __jsx(\"div\", {\n        className: \"card\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 7\n        }\n      }, __jsx(\"span\", {\n        className: \"right floated\",\n        key: index,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 9\n        }\n      }, group[3], __jsx(\"i\", {\n        className: \"user icon\",\n        style: {\n          margin: 3\n        },\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 11\n        }\n      }), __jsx(\"i\", {\n        className: \"circle outline icon\",\n        style: {\n          margin: 3\n        },\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }\n      })), __jsx(\"div\", {\n        className: \"content\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 9\n        }\n      }, __jsx(\"div\", {\n        className: \"header\",\n        style: styles.title,\n        key: index,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }\n      }, group[0])), __jsx(\"div\", {\n        className: \"content\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 9\n        }\n      }, __jsx(\"span\", {\n        className: \"right floated\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }\n      }, __jsx(Form.Button, {\n        onSubmit: onSubmit,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 13\n        }\n      }, \"Join Group\")), __jsx(\"div\", {\n        className: \"ui sub header\",\n        style: {\n          marginLeft: 10\n        },\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }\n      }, __jsx(\"i\", {\n        className: \"checkmark icon small\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 13\n        }\n      }), \"group\"), __jsx(\"div\", {\n        className: \"ui feed\",\n        style: {\n          marginLeft: 10\n        },\n        key: index,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }\n      }, group[1]))));\n    }) : __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 9\n      }\n    }, \" no groups found \");\n  }\n\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }\n  }), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 7\n    }\n  }), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }\n  }), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }\n  }), __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 7\n    }\n  }), __jsx(\"div\", {\n    className: \"App\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 9\n    }\n  }, displayGroupList())));\n};\n\n_s(JoinGroup, \"CUQhhjOEyY2hnZVPLxPnM/nVvFQ=\");\n\n_c = JoinGroup;\nexport default JoinGroup;\n\nvar _c;\n\n$RefreshReg$(_c, \"JoinGroup\");","map":{"version":3,"sources":["/home/wen_wong/voting-at-mcgill/client/src/pages/joinGroup.js"],"names":["React","useState","useEffect","VoteFactoryContract","getWeb3","Form","Header","require","styles","card","width","margin","color","maxHeight","minHeight","cursor","title","fontSize","marginLeft","marginTop","marginBottom","access","position","height","JoinGroup","web3","setWeb3","groupsID","setGroupsID","contract","setContract","renderedGroups","renderGroups","joiningGroup","setJoiningGroup","user","initWeb3","console","log","web3Instance","setup","eth","getAccounts","net","getId","networkId","deployedNetwork","networks","instance","Contract","abi","address","alert","error","displayVotes","methods","getExistingGroups","call","response","temp","i","length","parseInt","displayInfo","identification","getGroup","renderVotes","forEach","then","newGroup","push","setTimeout","onSubmit","event","preventDefault","joinGroup","groupID","send","from","setLoad","Load","displayJoin","getUserGroup","summary","setupVoteFactory","displayGroupList","map","group","index"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,mBAAP,MAAgC,+BAAhC;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,SAASC,IAAT,QAAoB,mBAApB;AACA,SAASC,MAAT,QAAuB,sBAAvB;AACA,OAAO,kCAAP;;AAEAC,OAAO,CAAC,6BAAD,CAAP,C,CAEA;;;AACA,IAAMC,MAAM,GAAG;AACbC,EAAAA,IAAI,EAAE;AACJC,IAAAA,KAAK,EAAE,KADH;AAEJC,IAAAA,MAAM,EAAE,MAFJ;AAGJC,IAAAA,KAAK,EAAE,SAHH;AAIJC,IAAAA,SAAS,EAAE,GAJP;AAKJC,IAAAA,SAAS,EAAE,GALP;AAMJC,IAAAA,MAAM,EAAE;AANJ,GADO;AASbC,EAAAA,KAAK,EAAG;AACNC,IAAAA,QAAQ,EAAE,EADJ;AAENL,IAAAA,KAAK,EAAE,SAFD;AAGNM,IAAAA,UAAU,EAAE,EAHN;AAINC,IAAAA,SAAS,EAAE,EAJL;AAKNC,IAAAA,YAAY,EAAC;AALP,GATK;AAgBbC,EAAAA,MAAM,EAAC;AACLC,IAAAA,QAAQ,EAAC,UADJ;AAELC,IAAAA,MAAM,EAAC,EAFF;AAGLN,IAAAA,QAAQ,EAAE;AAHL;AAhBM,CAAf,C,CAuBA;;AACA,IAAMO,SAAS,GAAG,SAAZA,SAAY,GAAM;AAAA;;AAAA,kBACEvB,QAAQ,CAAC,EAAD,CADV;AAAA,MACfwB,IADe;AAAA,MACTC,OADS;;AAAA,mBAEUzB,QAAQ,CAAC,EAAD,CAFlB;AAAA,MAEf0B,QAFe;AAAA,MAELC,WAFK;;AAAA,mBAGU3B,QAAQ,CAAC,EAAD,CAHlB;AAAA,MAGf4B,QAHe;AAAA,MAGLC,WAHK;;AAAA,mBAIiB7B,QAAQ,CAAC,EAAD,CAJzB;AAAA,MAIf8B,cAJe;AAAA,MAICC,YAJD;;AAAA,mBAKkB/B,QAAQ,CAAC,KAAD,CAL1B;AAAA,MAKfgC,YALe;AAAA,MAKDC,eALC;;AAOtB,MAAIC,IAAJ,CAPsB,CAStB;;AACAjC,EAAAA,SAAS,CAAC,YAAM;AAAA,aACCkC,QADD;AAAA;AAAA;;AAAA;AAAA,0EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AACEC,gBAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AADF;AAAA,uBAE6BlC,OAAO,EAFpC;;AAAA;AAEQmC,gBAAAA,YAFR;AAGEb,gBAAAA,OAAO,CAACa,YAAD,CAAP;;AAHF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADc;AAAA;AAAA;;AAMdH,IAAAA,QAAQ;AACT,GAPQ,EAOP,EAPO,CAAT,CAVsB,CAmBtB;;AACAlC,EAAAA,SAAS,CAAC,YAAM;AAAA,aACCsC,KADD;AAAA;AAAA;;AAAA;AAAA,wEACd;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,sBACKf,IAAI,IAAI,EADb;AAAA;AAAA;AAAA;;AAEIY,gBAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AAFJ;;AAAA;AAAA;AAAA;AAAA,uBAMmBb,IAAI,CAACgB,GAAL,CAASC,WAAT,EANnB;;AAAA;AAAA;AAAA;AAMKP,gBAAAA,IANL;AAAA;AAAA,uBAO4BV,IAAI,CAACgB,GAAL,CAASE,GAAT,CAAaC,KAAb,EAP5B;;AAAA;AAOUC,gBAAAA,SAPV;AAQUC,gBAAAA,eARV,GAQ4B3C,mBAAmB,CAAC4C,QAApB,CAA6BF,SAA7B,CAR5B;AASUG,gBAAAA,QATV,GASqB,IAAIvB,IAAI,CAACgB,GAAL,CAASQ,QAAb,CACf9C,mBAAmB,CAAC+C,GADL,EAEfJ,eAAe,IAAIA,eAAe,CAACK,OAFpB,CATrB;AAaIrB,gBAAAA,WAAW,CAACkB,QAAD,CAAX;AAbJ;AAAA;;AAAA;AAAA;AAAA;AAgBII,gBAAAA,KAAK,0EAAL;AAGAf,gBAAAA,OAAO,CAACgB,KAAR;;AAnBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADc;AAAA;AAAA;;AAuBZb,IAAAA,KAAK;AACR,GAxBQ,EAwBP,CAACf,IAAD,CAxBO,CAAT,CApBsB,CA8CtB;;AACAvB,EAAAA,SAAS,CAAC,YAAK;AACb,QAAIoD,YAAY;AAAA,0EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACdzB,QAAQ,IAAI,EADE;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,uBAIMA,QAAQ,CAAC0B,OAAT,CAAiBC,iBAAjB,GAAqCC,IAArC,EAJN;;AAAA;AAIXC,gBAAAA,QAJW;AAKXC,gBAAAA,IALW,GAKJ,EALI;;AAMjB,qBAASC,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAGF,QAAQ,CAACG,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACxCD,kBAAAA,IAAI,CAACC,CAAD,CAAJ,GAAUE,QAAQ,CAACJ,QAAQ,CAACE,CAAD,CAAT,CAAlB;AACD;;AACDvB,gBAAAA,OAAO,CAACC,GAAR,CAAYqB,IAAZ;AACA/B,gBAAAA,WAAW,CAAC+B,IAAD,CAAX;;AAViB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAZL,YAAY;AAAA;AAAA;AAAA,OAAhB;;AAYAA,IAAAA,YAAY;AACb,GAdQ,EAcP,CAACzB,QAAD,CAdO,CAAT;;AAkBA,MAAIkC,WAAW;AAAA,yEAAG,kBAAOC,cAAP;AAAA;AAAA;AAAA;AAAA;AAAA,oBACbrC,QAAQ,IAAI,EADC;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,qBAKDE,QAAQ,CAAC0B,OAAT,CAAiBU,QAAjB,CAA0BD,cAA1B,EAA0CP,IAA1C,EALC;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAOdpB,cAAAA,OAAO,CAACgB,KAAR;;AAPc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAXU,WAAW;AAAA;AAAA;AAAA,KAAf;;AAUA7D,EAAAA,SAAS,CAAC,YAAK;AAAC;AACd,QAAIgE,WAAW;AAAA,2EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACTvC,QADS;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAIVgC,gBAAAA,IAJU,GAIH,EAJG;AAAA;AAAA,uBAKRhC,QAAQ,CAACwC,OAAT,CAAiB,UAAAH,cAAc,EAAI;AACrCD,kBAAAA,WAAW,CAACC,cAAD,CAAX,CAA4BI,IAA5B,CAAiC,UAAAC,QAAQ,EAAI;AAC3C;AACAV,oBAAAA,IAAI,CAACW,IAAL,CAAUD,QAAV;AACH,mBAHC;AAIH,iBALK,CALQ;;AAAA;AAWdE,gBAAAA,UAAU,CAAC,YAAU;AACnBvC,kBAAAA,YAAY,CAAC2B,IAAD,CAAZ;AACD,iBAFS,EAEP,IAFO,CAAV;;AAXc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAXO,WAAW;AAAA;AAAA;AAAA,OAAf;;AAeAA,IAAAA,WAAW;AACZ,GAjBQ,EAiBP,CAACvC,QAAD,CAjBO,CAAT;AAmBAzB,EAAAA,SAAS,CAAC,YAAK;AACb,QAAG6B,cAAH,EAAmB;AACjBM,MAAAA,OAAO,CAACC,GAAR,CAAYP,cAAZ;AACD;AACF,GAJQ,EAIP,CAACA,cAAD,CAJO,CAAT;;AAMA,MAAIyC,QAAQ;AAAA,yEAAG,kBAAOC,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACbA,cAAAA,KAAK,CAACC,cAAN,GADa,CAGb;;AACIC,cAAAA,SAJS;AAAA,qFAIG;AAAA;AAAA;AAAA;AAAA;AAEZzC,0BAAAA,eAAe,CAAC,IAAD,CAAf;;AAFY,gCAGTL,QAAQ,IAAI,EAHH;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,iCAONA,QAAQ,CAAC0B,OAAT,CAAiBoB,SAAjB,CAA2BC,OAA3B,EAAoCC,IAApC,CAAyC;AAC3CC,4BAAAA,IAAI,EAAE3C;AADqC,2BAAzC,CAPM;;AAAA;AAUZD,0BAAAA,eAAe,CAAC,KAAD,CAAf;AACA6C,0BAAAA,OAAO,CAAC,CAACC,IAAF,CAAP;;AAXY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAJH;;AAAA,gCAITL,SAJS;AAAA;AAAA;AAAA;;AAkBTM,cAAAA,WAlBS;AAAA,qFAkBK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCACMpD,QAAQ,CAAC0B,OAAT,CAAiB2B,YAAjB,CAA8BN,OAA9B,EAAuCnB,IAAvC,EADN;;AAAA;AACV0B,0BAAAA,OADU;AAEhB9C,0BAAAA,OAAO,CAACC,GAAR,CAAY6C,OAAZ;;AAFgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAlBL;;AAAA,gCAkBTF,WAlBS;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAsBPG,gBAAgB,EAtBT;;AAAA;AAAA;AAAA,qBAuBPT,SAAS,EAvBF;;AAAA;AAAA;AAAA,qBAwBPM,WAAW,EAxBJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAART,QAAQ;AAAA;AAAA;AAAA,KAAZ;;AA2BA,WAASa,gBAAT,GAA4B;AAAA;;AAC1B,QAAI5D,IAAI,IAAI,EAAZ,EAAgB;AACd,aAAO,iCAAP;AACD,KAFD,MAIK,IAAIE,QAAQ,IAAI,EAAhB,EAAoB;AACvB,aAAO,sBAAP;AACD;;AAED,WAAOI,cAAc,GAAGA,cAAc,CAACuD,GAAf,CAAmB,UAACC,KAAD,EAAQC,KAAR;AAAA,aAC3C;AAAK,QAAA,SAAS,EAAC,SAAf;AAAyB,QAAA,KAAK,EAAEhF,MAAM,CAACC,IAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAM,QAAA,SAAS,EAAC,eAAhB;AAAgC,QAAA,GAAG,EAAE+E,KAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGD,KAAK,CAAC,CAAD,CADR,EAEE;AAAG,QAAA,SAAS,EAAC,WAAb;AAAyB,QAAA,KAAK,EAAE;AAAC5E,UAAAA,MAAM,EAAE;AAAT,SAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,EAGE;AAAG,QAAA,SAAS,EAAC,qBAAb;AAAmC,QAAA,KAAK,EAAE;AAACA,UAAAA,MAAM,EAAE;AAAT,SAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,CADF,EAOE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,QAAf;AAAwB,QAAA,KAAK,EAAEH,MAAM,CAACQ,KAAtC;AAA6C,QAAA,GAAG,EAAEwE,KAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACKD,KAAK,CAAC,CAAD,CADV,CADF,CAPF,EAYE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEE;AAAM,QAAA,SAAS,EAAC,eAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,IAAD,CAAM,MAAN;AAAa,QAAA,QAAQ,EAAEf,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,CAFF,EAME;AAAK,QAAA,SAAS,EAAC,eAAf;AAA+B,QAAA,KAAK,EAAE;AAACtD,UAAAA,UAAU,EAAC;AAAZ,SAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAG,QAAA,SAAS,EAAC,sBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,UANF,EAUE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAyB,QAAA,KAAK,EAAE;AAACA,UAAAA,UAAU,EAAC;AAAZ,SAAhC;AAAiD,QAAA,GAAG,EAAEsE,KAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA+DD,KAAK,CAAC,CAAD,CAApE,CAVF,CAZF,CADF,CAD2C;AAAA,KAAnB,CAAH,GA4BjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BA5BJ;AA6BD;;AAED,SACE,4BACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,EAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJF,EAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,EAME;AAAK,IAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAOF,gBAAgB,EAAvB,CADF,CANF,CADF;AAYD,CAnLD;;GAAM7D,S;;KAAAA,S;AAqLN,eAAeA,SAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport VoteFactoryContract from \"../contracts/VoteFactory.json\";\nimport getWeb3 from \"../getWeb3\";\nimport { Form} from \"semantic-ui-react\";\nimport { Header } from '../components/header';\nimport 'semantic-ui-css/semantic.min.css';\n\nrequire(\"regenerator-runtime/runtime\");\n\n// Card UI details\nconst styles = {\n  card: {\n    width: '90%',\n    margin: 'auto',\n    color: '#f00000',\n    maxHeight: 200,\n    minHeight: 200,\n    cursor: \"pointer\",\n  },\n  title : {\n    fontSize: 36,\n    color: '#ED1B2F',\n    marginLeft: 10,\n    marginTop: 15,\n    marginBottom:15\n  },\n  access:{\n    position:\"relative\",\n    height:36,\n    fontSize: 16,\n  }\n};\n\n// Initialize Join Group page\nconst JoinGroup = () => {\n  const [web3, setWeb3] = useState('');\n  const [groupsID, setGroupsID] = useState('');\n  const [contract, setContract] = useState('');\n  const [renderedGroups, renderGroups] = useState([]);\n  const [joiningGroup, setJoiningGroup] = useState(false);\n\n  var user;\n\n  // Setup Web3 on the current page\n  useEffect(() => {\n    async function initWeb3() {\n      console.log('initializing web3');\n      const web3Instance = await getWeb3();\n      setWeb3(web3Instance)\n    }\n    initWeb3();\n  },[]);\n\n  // Initializeing VoteFactory contract\n  useEffect(() => {\n    async function setup() {\n      if(web3 == \"\") {\n        console.log('unable to get factory')\n        return;\n      }\n      try {\n        [user] = await web3.eth.getAccounts();\n        const networkId = await web3.eth.net.getId();\n        const deployedNetwork = VoteFactoryContract.networks[networkId];\n        const instance = new web3.eth.Contract(\n          VoteFactoryContract.abi,\n          deployedNetwork && deployedNetwork.address,\n        );\n        setContract(instance);\n    \n      } catch (error) {\n        alert(\n          `Failed to load web3, accounts, or contract. Check console for details.`,\n        );\n        console.error(error);\n      }\n    }\n      setup();\n  },[web3]);\n\n  // Return all group IDs as an array\n  useEffect(()=> {\n    var displayVotes = async () => {\n      if(contract == '') {\n        return;\n      }\n      const response = await contract.methods.getExistingGroups().call();\n      const temp = [];\n      for (var i = 0; i < response.length; i++) {\n        temp[i] = parseInt(response[i]);\n      }\n      console.log(temp);\n      setGroupsID(temp);\n    };\n    displayVotes();\n  },[contract]);\n  \n\n\n  var displayInfo = async (identification) => { \n    if(groupsID == '') {\n      return;\n    }\n    try {\n      return await contract.methods.getGroup(identification).call();\n    } catch (error) {\n      console.error(error);\n    }\n  };\n  useEffect(()=> {//render votes\n    var renderVotes = async () => {\n        if (!groupsID) {\n          return;\n        }\n        var temp = [];\n        await groupsID.forEach(identification => {\n            displayInfo(identification).then(newGroup => {\n              // Check if user has joined the group\n              temp.push(newGroup);\n          });\n        });\n        setTimeout(function(){\n          renderGroups(temp);\n        }, 1000);\n      }\n    renderVotes();\n  },[groupsID]);\n\n  useEffect(()=> {\n    if(renderedGroups) {\n      console.log(renderedGroups);\n    }\n  },[renderedGroups]);\n\n  var onSubmit = async (event) => {\n    event.preventDefault();\n    \n    // Calls VoteFactory Contract to create a new instance of Group\n    var joinGroup = async () => {\n      \n        setJoiningGroup(true);\n        if(contract == ''){\n            return;\n        }\n        // Calls the method createGroup from VoteFactory.sol\n        await contract.methods.joinGroup(groupID).send({\n            from: user\n        });\n        setJoiningGroup(false);\n        setLoad(!Load);\n    };\n\n    var displayJoin = async () => {\n      const summary = await contract.methods.getUserGroup(groupID).call();\n      console.log(summary);\n  };\n    await setupVoteFactory();\n    await joinGroup();\n    await displayJoin();\n  };\n  \n  function displayGroupList() {\n    if (web3 == \"\") {\n      return \"waiting for votes to display...\";\n    }\n\n    else if (groupsID == \"\") {\n      return \"no groups to display\";\n    }\n\n    return renderedGroups ? renderedGroups.map((group, index) =>\n    <div className=\"ui card\" style={styles.card}>\n      <div className=\"card\">\n        <span className=\"right floated\" key={index}>\n          {group[3]}\n          <i className=\"user icon\" style={{margin: 3}}></i>\n          <i className=\"circle outline icon\" style={{margin: 3}}></i>\n        </span>\n\n        <div className=\"content\">\n          <div className=\"header\" style={styles.title} key={index}>\n              {group[0]}\n          </div>\n        </div>\n        <div className=\"content\">\n\n          <span className=\"right floated\">\n            <Form.Button onSubmit={onSubmit}>Join Group</Form.Button>\n          </span>\n\n          <div className=\"ui sub header\" style={{marginLeft:10}}>\n            <i className=\"checkmark icon small\"></i>  \n            group \n          </div>\n          <div className=\"ui feed\" style={{marginLeft:10}} key={index}>{ group[1] }</div>\n        </div>\n      </div>\n    </div>\n    ) : <div> no groups found </div>\n  }\n\n  return( \n    <>\n      <Header></Header>\n      <br></br>\n      <br></br>\n      <br></br>\n      <br></br>\n      <div className=\"App\">\n        <div>{ displayGroupList() }</div>\n      </div>\n    </>\n  ); \n};\n\nexport default JoinGroup;"]},"metadata":{},"sourceType":"module"}